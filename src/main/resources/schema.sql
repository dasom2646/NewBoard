-- 맴버 테이블 생성
CREATE TABLE IF NOT EXISTS TB_MEMBER
(
    MEMBER_SEQ BIGINT PRIMARY KEY,
    MEMBER_ID VARCHAR(255) NOT NULL,
    MEMBER_NICKNAME VARCHAR(255) NOT NULL,
    MEMBER_NAME VARCHAR(255) NOT NULL,
    MEMBER_PWD VARCHAR(255) NOT NULL
    );


-- 보드 테이블 생성
CREATE TABLE IF NOT EXISTS TB_BOARD(
    BOARD_SEQ  BIGINT  PRIMARY KEY NOT NULL,
    BOARD_TITLE VARCHAR(100) NOT NULL,
    BOARD_CONTENT TEXT NOT NULL,
    CREATED_DATE TIMESTAMP NOT NULL,
    BOARD_VIEWS INT DEFAULT 0,
    CATEGORY VARCHAR(255) NOT NULL,
    FILENAME VARCHAR(255), -- 파일명 컬럼 추가
    MEMBER_SEQ BIGINT, -- 맴버 테이블의 시퀀스를 참조하는 외래 키
    CONSTRAINT fk_MEMBER_SEQ FOREIGN KEY (MEMBER_SEQ) REFERENCES TB_MEMBER (MEMBER_SEQ)
    );

-- 댓글 테이블 생성
CREATE TABLE TB_COMMENT (
    COMMENT_SEQ BIGINT PRIMARY KEY NOT NULL,
    CONTENT VARCHAR(1000),
    CREATED_DATE TIMESTAMP NOT NULL,
    MEMBER_SEQ BIGINT,
    BOARD_SEQ BIGINT,
    CONSTRAINT fk_COMMENT_MEMBER_SEQ FOREIGN KEY (MEMBER_SEQ) REFERENCES TB_MEMBER(MEMBER_SEQ),
    CONSTRAINT fk_COMMENT_BOARD_SEQ FOREIGN KEY (BOARD_SEQ) REFERENCES TB_BOARD(BOARD_SEQ)
);
-- 대댓글 테이블 생성
CREATE TABLE TB_COMMENT_REPLY (
    REPLY_SEQ BIGINT PRIMARY KEY NOT NULL,
    CONTENT VARCHAR(1000),
    CREATED_DATE TIMESTAMP NOT NULL,
    MEMBER_SEQ BIGINT,
    BOARD_SEQ BIGINT,
    PARENT_COMMENT_SEQ BIGINT, -- 부모 댓글을 식별하기 위한 열
    CONSTRAINT fk_REPLY_MEMBER_SEQ FOREIGN KEY (MEMBER_SEQ) REFERENCES TB_MEMBER(MEMBER_SEQ),
    CONSTRAINT fk_REPLY_BOARD_SEQ FOREIGN KEY (BOARD_SEQ) REFERENCES TB_BOARD(BOARD_SEQ),
    CONSTRAINT fk_REPLY_PARENT_COMMENT_SEQ FOREIGN KEY (PARENT_COMMENT_SEQ) REFERENCES TB_COMMENT(COMMENT_SEQ)
);


-- 좋아요 테이블 생성
CREATE TABLE IF NOT EXISTS TB_LIKE (
    LIKE_SEQ BIGINT PRIMARY KEY NOT NULL,
    MEMBER_SEQ BIGINT, -- 맴버 테이블의 시퀀스를 참조하는 외래 키
    BOARD_SEQ BIGINT, -- 게시판 테이블의 시퀀스를 참조하는 외래 키
    CREATED_AT TIMESTAMP NOT NULL,
    CONSTRAINT fk_LIKE_MEMBER_SEQ FOREIGN KEY (MEMBER_SEQ) REFERENCES TB_MEMBER (MEMBER_SEQ),
    CONSTRAINT fk_LIKE_BOARD_SEQ FOREIGN KEY (BOARD_SEQ) REFERENCES TB_BOARD (BOARD_SEQ)
);

-- 시퀀스
CREATE SEQUENCE IF NOT EXISTS MEMBER_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE IF NOT EXISTS BOARD_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE IF NOT EXISTS COMMENT_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE IF NOT EXISTS LIKE_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE IF NOT EXISTS REPLY_SEQ START WITH 1 INCREMENT BY 1;

